

# üß† Gemini-Powered Psychometric Interview & Chatbot

This is a Python Flask application that combines **Google Gemini** (via the `google-genai` SDK on Vertex AI) for dynamic psychometric assessments with an external **Dialogflow** client for general conversational chat functionality.

The core function is to dynamically generate five open-ended psychometric questions, collect user responses, and then use a second Gemini call to generate a detailed, data-driven personality analysis.

## ‚ú® Features

*   **Dynamic Question Generation:** Uses the Gemini model (`gemini-2.0-flash-exp`) to generate 5 unique, insightful psychometric questions on demand.
*   **AI-Powered Analysis:** Generates a detailed personality assessment based on user responses, covering work style, decision-making, communication, strengths, and growth areas.
*   **Stateful Assessment Flow:** Manages the multi-step Q&A process using global state (`current_question_index`, `user_responses`).
*   **Conversational Chat Integration:** Includes a separate endpoint for general chat using a placeholder `DialogflowClient`.
*   **Vertex AI Integration:** Configured to use the `google-genai` SDK with a specific Vertex AI project and location.

## üõ†Ô∏è Setup and Installation

### Prerequisites

1.  **Python 3.8+**
2.  **Google Cloud Project:** Access to a Google Cloud project with the **Vertex AI API** enabled.
3.  **Authentication:** Ensure you are authenticated with Google Cloud using Application Default Credentials (ADC) for local development:
    ```bash
    gcloud auth application-default login
    ```
4.  **Dialogflow Client:** The code relies on an external module named `dialogflow_client`. **This file is not included** and must be created or mocked to run the application fully.

### 1. Clone the repository (Assuming the code is in a file named `app.py`)

```bash
git clone <repository-url>
cd <repository-directory>
```

### 2. Create a virtual environment and install dependencies

```bash
python3 -m venv venv
source venv/bin/activate  # On Windows use `venv\Scripts\activate`
pip install -r requirements.txt
```

**`requirements.txt` contents:**

```
Flask
google-genai
```
*(Note: You will also need to handle the `dialogflow_client` import error if you intend to use the `/chat` route.)*

## ‚öôÔ∏è Configuration

### 1. Vertex AI Client Configuration

You **must** modify the following lines in the global scope (where the client is initialized) to match your Google Cloud environment:

```python
# Initialize Gemini client
client = genai.Client(
    vertexai=True,
    project="ng-project-102",  # <-- CHANGE THIS to YOUR GCP Project ID
    location="us-central1",    # <-- CHANGE THIS if necessary
)
model = "gemini-2.0-flash-exp" # Ensure this model is available
```

### 2. Dialogflow Integration

The current implementation assumes a working `DialogflowClient` class:

```python
from dialogflow_client import DialogflowClient
dialogflow_client = DialogflowClient()
```
If you do not intend to use the `/chat` endpoint, you can remove the related imports, initialization, and the `@app.route('/chat')` function. Otherwise, you must provide the source code for `dialogflow_client.py`.

## üöÄ Usage

### 1. Run the application

```bash
python app.py
# Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
```

### 2. API Endpoints and Workflow

The primary functionality is driven by three API endpoints used in a sequential flow:

| Endpoint | Method | Purpose | Workflow Stage | Request Body |
| :--- | :--- | :--- | :--- | :--- |
| `/` | `GET` | Renders the frontend HTML page (`index.html` - **required but not provided**). | N/A | N/A |
| `/chat` | `POST` | General conversation using the external Dialogflow client. | N/A | `{"message": "Hello"}` |
| `/start_psych_test` | `POST` | **Initiates the assessment.** Gemini generates 5 questions and returns the first one. | Start | `{}` |
| `/psych_test_response` | `POST` | Submits an answer. Returns the next question or the final analysis. | In-Progress/Complete | `{"message": "My response to the last question."}` |

### Psychometric Assessment Flow

The test follows this stateful interaction:

1.  **Request:** POST to `/start_psych_test`.
2.  **Response:** Receives Question 1 (e.g., "Question 1: How do you handle conflict in a team?").
3.  **Loop (Q1 to Q4):** POST to `/psych_test_response` with the answer. Receives the next question.
4.  **Final Response (Q5):** POST to `/psych_test_response` with the final answer.
5.  **Final Output:** Receives the detailed personality analysis generated by Gemini.
